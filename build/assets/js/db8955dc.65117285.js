"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[3437],{5298:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var t=a(4848),s=a(8453);const r={title:"Building ROS 2 Packages"},i="Building ROS 2 Packages",c={id:"ros2-packages/building-packages",title:"Building ROS 2 Packages",description:"Package Creation Process",source:"@site/docs/physical-ai/ros2-packages/building-packages.mdx",sourceDirName:"ros2-packages",slug:"/ros2-packages/building-packages",permalink:"/ros2-packages/building-packages",draft:!1,unlisted:!1,editUrl:"https://github.com/MuhammadFuzail591/new-book-physical-ai/tree/main/docs/physical-ai/ros2-packages/building-packages.mdx",tags:[],version:"current",frontMatter:{title:"Building ROS 2 Packages"},sidebar:"tutorialSidebar",previous:{title:"Chapter 5 - Building ROS 2 Packages, Launch Files & Parameters",permalink:"/ros2-packages/"},next:{title:"Launch Files in ROS 2",permalink:"/ros2-packages/launch-files"}},l={},o=[{value:"Package Creation Process",id:"package-creation-process",level:2},{value:"Creating C++ Packages",id:"creating-c-packages",level:3},{value:"Creating Python Packages",id:"creating-python-packages",level:3},{value:"Package Dependencies and Management",id:"package-dependencies-and-management",level:3},{value:"Advanced Build Configuration",id:"advanced-build-configuration",level:3},{value:"Build Process and Best Practices",id:"build-process-and-best-practices",level:2},{value:"Building Packages",id:"building-packages",level:3},{value:"Testing and Quality Assurance",id:"testing-and-quality-assurance",level:3},{value:"Package Distribution and Installation",id:"package-distribution-and-installation",level:2},{value:"Creating Installable Packages",id:"creating-installable-packages",level:3},{value:"Creating Debian Packages",id:"creating-debian-packages",level:3},{value:"Common Package Patterns",id:"common-package-patterns",level:2},{value:"Node Container Pattern",id:"node-container-pattern",level:3},{value:"Library Package Pattern",id:"library-package-pattern",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"building-ros-2-packages",children:"Building ROS 2 Packages"}),"\n",(0,t.jsx)(n.h2,{id:"package-creation-process",children:"Package Creation Process"}),"\n",(0,t.jsx)(n.p,{children:"Creating a ROS 2 package involves several steps that establish the proper structure and dependencies for your robotic application. The process differs slightly between C++ and Python packages, but both follow the same fundamental principles."}),"\n",(0,t.jsx)(n.h3,{id:"creating-c-packages",children:"Creating C++ Packages"}),"\n",(0,t.jsxs)(n.p,{children:["To create a C++ package, use the ",(0,t.jsx)(n.code,{children:"ament_cmake"})," build system:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create a C++ package\nros2 pkg create --build-type ament_cmake my_robot_controller\n"})}),"\n",(0,t.jsx)(n.p,{children:"This command creates the basic package structure with CMakeLists.txt and package.xml files properly configured for C++ development."}),"\n",(0,t.jsx)(n.h3,{id:"creating-python-packages",children:"Creating Python Packages"}),"\n",(0,t.jsx)(n.p,{children:"For Python packages, you can specify the build type:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create a Python package\nros2 pkg create --build-type ament_python my_robot_controller_py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"package-dependencies-and-management",children:"Package Dependencies and Management"}),"\n",(0,t.jsxs)(n.p,{children:["Managing dependencies is crucial for maintainable ROS 2 packages. Dependencies are declared in the ",(0,t.jsx)(n.code,{children:"package.xml"})," file and must be properly specified to ensure proper building and execution."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Example package.xml with comprehensive dependencies --\x3e\n<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>my_robot_controller</name>\n  <version>1.0.0</version>\n  <description>Advanced Robot Controller Package</description>\n  <maintainer email="maintainer@example.com">Maintainer Name</maintainer>\n  <license>Apache License 2.0</license>\n\n  \x3c!-- Build tool dependencies --\x3e\n  <buildtool_depend>ament_cmake</buildtool_depend>\n\n  \x3c!-- Core ROS 2 dependencies --\x3e\n  <depend>rclcpp</depend>\n  <depend>rclpy</depend>\n  <depend>std_msgs</depend>\n  <depend>geometry_msgs</depend>\n  <depend>sensor_msgs</depend>\n  <depend>nav_msgs</depend>\n\n  \x3c!-- Custom message dependencies --\x3e\n  <build_depend>rosidl_default_generators</build_depend>\n  <exec_depend>rosidl_default_runtime</exec_depend>\n  <member_of_group>rosidl_interface_packages</member_of_group>\n\n  \x3c!-- Testing dependencies --\x3e\n  <test_depend>ament_lint_auto</test_depend>\n  <test_depend>ament_lint_common</test_depend>\n\n  <export>\n    <build_type>ament_cmake</build_type>\n  </export>\n</package>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"advanced-build-configuration",children:"Advanced Build Configuration"}),"\n",(0,t.jsx)(n.p,{children:"For complex packages with multiple components, the CMakeLists.txt requires careful configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:'cmake_minimum_required(VERSION 3.8)\nproject(my_robot_controller)\n\n# Set C++ standard\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# Find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rclcpp REQUIRED)\nfind_package(std_msgs REQUIRED)\nfind_package(geometry_msgs REQUIRED)\nfind_package(sensor_msgs REQUIRED)\nfind_package(nav_msgs REQUIRED)\n\n# Custom message generation (if needed)\nfind_package(rosidl_default_generators REQUIRED)\n\n# Define custom messages and services\nset(MSG_FILES\n  "msg/RobotState.msg"\n  "msg/SensorData.msg"\n)\n\nset(SRV_FILES\n  "srv/RobotControl.srv"\n  "srv/Navigation.srv"\n)\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  ${MSG_FILES}\n  ${SRV_FILES}\n  DEPENDENCIES std_msgs geometry_msgs sensor_msgs\n)\n\n# Build multiple executables\nadd_executable(robot_controller src/robot_controller.cpp)\nadd_executable(sensor_processor src/sensor_processor.cpp)\nadd_executable(path_planner src/path_planner.cpp)\n\n# Link dependencies\nament_target_dependencies(robot_controller\n  rclcpp\n  std_msgs\n  geometry_msgs\n  sensor_msgs\n  ${PROJECT_NAME}  # For custom messages\n)\n\nament_target_dependencies(sensor_processor\n  rclcpp\n  sensor_msgs\n  std_msgs\n)\n\nament_target_dependencies(path_planner\n  rclcpp\n  geometry_msgs\n  nav_msgs\n)\n\n# Install targets\ninstall(TARGETS\n  robot_controller\n  sensor_processor\n  path_planner\n  DESTINATION lib/${PROJECT_NAME}\n)\n\ninstall(DIRECTORY\n  launch\n  config\n  DESTINATION share/${PROJECT_NAME}/\n)\n\nif(BUILD_TESTING)\n  find_package(ament_lint_auto REQUIRED)\n  ament_lint_auto_find_test_dependencies()\nendif()\n\nament_package()\n'})}),"\n",(0,t.jsx)(n.h2,{id:"build-process-and-best-practices",children:"Build Process and Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"building-packages",children:"Building Packages"}),"\n",(0,t.jsxs)(n.p,{children:["The build process in ROS 2 is managed by ",(0,t.jsx)(n.code,{children:"colcon"}),", the build tool that handles multiple packages efficiently:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Build a single package\ncolcon build --packages-select my_robot_controller\n\n# Build with specific options\ncolcon build --packages-select my_robot_controller --cmake-args -DCMAKE_BUILD_TYPE=Release\n\n# Build all packages in workspace\ncolcon build\n\n# Build with parallel jobs\ncolcon build --parallel-workers 4\n"})}),"\n",(0,t.jsx)(n.h3,{id:"testing-and-quality-assurance",children:"Testing and Quality Assurance"}),"\n",(0,t.jsx)(n.p,{children:"Comprehensive testing is essential for reliable robotic applications:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// Example test file: test/test_robot_controller.cpp\n#include <gtest/gtest.h>\n#include <rclcpp/rclcpp.hpp>\n#include "my_robot_controller/robot_controller.hpp"\n\nclass TestRobotController : public ::testing::Test {\nprotected:\n    void SetUp() override {\n        rclcpp::init(0, nullptr);\n    }\n\n    void TearDown() override {\n        rclcpp::shutdown();\n    }\n};\n\nTEST_F(TestRobotController, TestInitialization) {\n    auto node = std::make_shared<RobotController>();\n    ASSERT_NE(node, nullptr);\n    EXPECT_TRUE(node->is_initialized());\n}\n\nint main(int argc, char ** argv) {\n    ::testing::InitGoogleTest(&argc, argv);\n    return RUN_ALL_TESTS();\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Add test configuration to CMakeLists.txt:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"# Add testing configuration\nif(BUILD_TESTING)\n  find_package(ament_cmake_gtest REQUIRED)\n  find_package(ament_lint_auto REQUIRED)\n\n  ament_add_gtest(test_robot_controller\n    test/test_robot_controller.cpp\n  )\n  ament_target_dependencies(test_robot_controller\n    rclcpp\n    std_msgs\n    geometry_msgs\n  )\n\n  ament_lint_auto_find_test_dependencies()\nendif()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"package-distribution-and-installation",children:"Package Distribution and Installation"}),"\n",(0,t.jsx)(n.h3,{id:"creating-installable-packages",children:"Creating Installable Packages"}),"\n",(0,t.jsx)(n.p,{children:"For distribution, packages need proper installation rules:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"# Installation rules for executables\ninstall(TARGETS\n  robot_controller\n  sensor_processor\n  path_planner\n  RUNTIME DESTINATION lib/${PROJECT_NAME}\n)\n\n# Installation rules for libraries\ninstall(TARGETS\n  robot_core_lib\n  LIBRARY DESTINATION lib\n  ARCHIVE DESTINATION lib\n)\n\n# Installation rules for other files\ninstall(DIRECTORY\n  launch/\n  config/\n  DESTINATION share/${PROJECT_NAME}/\n)\n\ninstall(FILES\n  README.md\n  DESTINATION share/${PROJECT_NAME}/\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"creating-debian-packages",children:"Creating Debian Packages"}),"\n",(0,t.jsx)(n.p,{children:"For distribution to end users, you can create Debian packages:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"\x3c!-- Additional metadata for packaging in package.xml --\x3e\n<export>\n  <build_type>ament_cmake</build_type>\n  <rosdoc2>rosdoc2.standard</rosdoc2>\n</export>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-package-patterns",children:"Common Package Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"node-container-pattern",children:"Node Container Pattern"}),"\n",(0,t.jsx)(n.p,{children:"For organizing multiple related nodes:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// robot_system.cpp - Container for multiple nodes\n#include <rclcpp/rclcpp.hpp>\n#include "robot_controller.hpp"\n#include "sensor_processor.hpp"\n#include "path_planner.hpp"\n\nint main(int argc, char * argv[]) {\n    rclcpp::init(argc, argv);\n\n    // Create multiple nodes in the same process\n    auto controller = std::make_shared<RobotController>();\n    auto sensor_processor = std::make_shared<SensorProcessor>();\n    auto path_planner = std::make_shared<PathPlanner>();\n\n    // Create executor to manage all nodes\n    rclcpp::executors::MultiThreadedExecutor executor;\n    executor.add_node(controller);\n    executor.add_node(sensor_processor);\n    executor.add_node(path_planner);\n\n    executor.spin();\n\n    rclcpp::shutdown();\n    return 0;\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"library-package-pattern",children:"Library Package Pattern"}),"\n",(0,t.jsx)(n.p,{children:"For creating reusable libraries:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"# Create a shared library\nadd_library(robot_core_lib\n  src/pid_controller.cpp\n  src/kinematics.cpp\n  src/utils.cpp\n)\n\ntarget_include_directories(robot_core_lib PUBLIC\n  $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>\n  $<INSTALL_INTERFACE:include>\n)\n\nament_target_dependencies(robot_core_lib\n  rclcpp\n  geometry_msgs\n)\n\n# Export the library\nament_export_targets(robot_core_lib HAS_LIBRARY_TARGET)\nament_export_dependencies(rclcpp geometry_msgs)\n\n# Install headers\ninstall(\n  DIRECTORY include/\n  DESTINATION include\n)\n\ninstall(\n  TARGETS robot_core_lib\n  EXPORT robot_core_lib\n  LIBRARY DESTINATION lib\n  ARCHIVE DESTINATION lib\n  RUNTIME DESTINATION bin\n  INCLUDES DESTINATION include\n)\n"})}),"\n",(0,t.jsx)(n.p,{children:"This comprehensive approach to building ROS 2 packages ensures that your robotic applications are well-structured, maintainable, and follow best practices for the ROS 2 ecosystem."})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>c});var t=a(6540);const s={},r=t.createContext(s);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);